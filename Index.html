<!DOCTYPE html>
<html lang="en" class="transition-colors duration-300">
<head>
<link rel="stylesheet" href="style.css">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Thumbnail4U</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  darkMode: 'class'
}
</script>
<style>
.canvas-wrapper {
  width: 100%;
  max-width: 640px;
  aspect-ratio: 16/9;
  position: relative;
}
canvas {
  width: 100%;
  height: 100%;
  border-radius: 12px;
}
</style>
</head>

<body class="bg-gray-100 text-gray-900 dark:bg-slate-950 dark:text-white">

<!-- NAVBAR -->
<nav class="flex justify-between items-center px-8 py-5 shadow-md bg-white dark:bg-slate-900">
  <div class="flex items-center gap-3">
    <div class="w-3 h-3 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full"></div>
    <h1 class="text-xl font-semibold tracking-wide text-slate-800 dark:text-white">
      <span class="text-blue-600 dark:text-blue-400">Thumbnail</span>
      <span class="font-bold text-purple-600 dark:text-purple-400">4U</span>
    </h1>
  </div>
  <div class="flex gap-4 items-center">
    <button id="themeToggle" class="px-4 py-2 rounded bg-gray-200 dark:bg-slate-700 hover:opacity-80 transition">
      Toggle Mode
    </button>
    <button class="px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">
      Upgrade
    </button>
  </div>
</nav>

<!-- MAIN -->
<div class="max-w-6xl mx-auto p-8 grid md:grid-cols-2 gap-10">

  <!-- LEFT SIDE -->
  <div class="space-y-6">
    <div>
      <label class="block font-medium mb-2">Upload Image</label>
      <input type="file" id="imageUpload" accept="image/*"
        class="w-full p-3 border rounded-lg dark:bg-slate-800 dark:border-slate-700">
    </div>

    <div>
      <label class="block font-medium mb-2">Thumbnail Prompt</label>
      <textarea id="promptInput" rows="3"
        placeholder="Example: Dramatic, bold yellow text saying I QUIT"
        class="w-full p-3 border rounded-lg dark:bg-slate-800 dark:border-slate-700"></textarea>
    </div>

    <button id="generateBtn"
      class="w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg text-lg hover:opacity-90 transition">
      Generate Thumbnail
    </button>

    <button id="downloadBtn"
      class="w-full py-3 bg-green-600 text-white rounded-lg text-lg hover:bg-green-700 transition">
      Download Thumbnail
    </button>
  </div>

  <!-- RIGHT SIDE -->
  <div class="flex justify-center items-start">
    <div class="canvas-wrapper bg-black shadow-2xl rounded-xl overflow-hidden">
      <canvas id="thumbnailCanvas" width="1280" height="720"></canvas>
    </div>
  </div>

</div>

<!-- CONTENT SECTION -->
<div class="max-w-4xl mx-auto px-8 pb-16 space-y-8">

  <div>
    <h2 class="text-xl font-semibold mb-3">Generated Titles</h2>
    <ul id="titlesList" class="space-y-3"></ul>
  </div>

  <div>
    <h2 class="text-xl font-semibold mb-3">Description</h2>
    <p id="descriptionOutput" class="opacity-90"></p>
  </div>

  <div>
    <h2 class="text-xl font-semibold mb-3">Tags</h2>
    <p id="tagsOutput" class="opacity-90"></p>
  </div>

</div>

<script>
const canvas = document.getElementById("thumbnailCanvas");
const ctx = canvas.getContext("2d");
let uploadedImage = null;

// ===== DARK MODE =====
const themeToggle = document.getElementById("themeToggle");
themeToggle.addEventListener("click", () => {
  document.documentElement.classList.toggle("dark");
  localStorage.setItem("theme", document.documentElement.classList.contains("dark"));
});
if(localStorage.getItem("theme") === "true") {
  document.documentElement.classList.add("dark");
}

// ===== IMAGE UPLOAD =====
document.getElementById("imageUpload").addEventListener("change", function(e){
  const reader = new FileReader();
  reader.onload = function(event){
    uploadedImage = new Image();
    uploadedImage.onload = () => generateThumbnail();
    uploadedImage.src = event.target.result;
  };
  reader.readAsDataURL(e.target.files[0]);
});

// ===== MAIN GENERATOR =====
function generateThumbnail(){
  if(!uploadedImage) return;

  const prompt = document.getElementById("promptInput").value.toLowerCase();

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // --- STYLE DETECTION ---
  let contrast = 120;
  let brightness = 110;
  let saturation = 120;
  let textColor = "yellow";
  let strokeColor = "black";

  if(prompt.includes("dramatic") || prompt.includes("intense")){
    contrast = 140;
    brightness = 95;
    saturation = 130;
    textColor = "red";
  }

  if(prompt.includes("clean") || prompt.includes("minimal")){
    contrast = 105;
    brightness = 110;
    saturation = 100;
    textColor = "white";
  }

  if(prompt.includes("dark")){
    brightness = 80;
  }

  if(prompt.includes("bright")){
    brightness = 120;
  }

  ctx.filter = `contrast(${contrast}%) brightness(${brightness}%) saturate(${saturation}%)`;

  // --- IMAGE FIT ---
  const ratio = Math.min(canvas.width/uploadedImage.width, canvas.height/uploadedImage.height);
  const newWidth = uploadedImage.width * ratio;
  const newHeight = uploadedImage.height * ratio;
  const x = (canvas.width - newWidth)/2;
  const y = (canvas.height - newHeight)/2;

  ctx.drawImage(uploadedImage, x, y, newWidth, newHeight);

  // --- TEXT EXTRACTION ---
  const headline = extractHeadline(prompt);

  drawFittedText(headline.toUpperCase(), textColor, strokeColor);

  addWatermark();
  generateTextContent(prompt);
}

// ===== SMART HEADLINE EXTRACTION =====
function extractHeadline(prompt){
  const stopWords = ["make", "this", "image", "with", "and", "dramatic", "bright", "dark", "clean", "minimal"];
  const words = prompt.split(" ").filter(word => !stopWords.includes(word));
  return words.slice(0,6).join(" ") || "NEW VIDEO";
}

// ===== AUTO TEXT FIT ENGINE =====
function drawFittedText(text, fillColor, strokeColor){
  ctx.filter = "none";
  let fontSize = 140;
  let lines = [];

  do {
    ctx.font = `bold ${fontSize}px Impact`;
    lines = wrapText(text, canvas.width - 200);
    fontSize -= 5;
  } while ((lines.length * fontSize) > 500 && fontSize > 40);

  ctx.textAlign = "center";
  ctx.lineWidth = fontSize * 0.08;
  ctx.strokeStyle = strokeColor;
  ctx.fillStyle = fillColor;

  const startY = canvas.height - (lines.length * fontSize) - 60;

  lines.forEach((line, index) => {
    ctx.strokeText(line, canvas.width/2, startY + (index * fontSize));
    ctx.fillText(line, canvas.width/2, startY + (index * fontSize));
  });
}

// ===== WORD WRAP =====
function wrapText(text, maxWidth){
  const words = text.split(" ");
  const lines = [];
  let currentLine = words[0];

  for(let i=1; i<words.length; i++){
    const testLine = currentLine + " " + words[i];
    const metrics = ctx.measureText(testLine);
    if(metrics.width < maxWidth){
      currentLine = testLine;
    } else {
      lines.push(currentLine);
      currentLine = words[i];
    }
  }
  lines.push(currentLine);
  return lines;
}

// ===== WATERMARK =====
function addWatermark(){
  ctx.font = "36px Arial";
  ctx.fillStyle = "rgba(255,255,255,0.6)";
  ctx.fillText("Thumbnail4U Free", canvas.width - 320, 60);
}

// ===== TEXT GENERATION =====
function generateTextContent(prompt){
  const titles = [
    `I Tried ${prompt}... Here's What Happened`,
    `This Completely Changed Everything`,
    `You Wonâ€™t Believe What Happened`
  ];

  const description = `In this video, we explore ${prompt}. Watch until the end to see the full results and transformation.`;

  const tags = `${prompt}, youtube growth, content strategy, thumbnail tips`;

  const titlesList = document.getElementById("titlesList");
  titlesList.innerHTML = "";

  titles.forEach(title => {
    const li = document.createElement("li");
    li.textContent = title;
    li.className = "p-3 rounded-lg bg-gray-200 dark:bg-slate-800";
    titlesList.appendChild(li);
  });

  document.getElementById("descriptionOutput").textContent = description;
  document.getElementById("tagsOutput").textContent = tags;
}

// ===== BUTTON =====
document.getElementById("generateBtn").addEventListener("click", generateThumbnail);

// ===== DOWNLOAD =====
document.getElementById("downloadBtn").addEventListener("click", function(){
  const link = document.createElement("a");
  link.download = "thumbnail.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
});
</script>

</body>
</html>
